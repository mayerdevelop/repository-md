import { Component, ViewChild } from '@angular/core';
import { Subject } from 'rxjs';
import { poToasterLiterals } from './po-toaster.literals';
import { PoToasterBaseComponent } from './po-toaster-base.component';
import { PoToasterType } from './po-toaster-type.enum';
import { PoToasterOrientation } from './po-toaster-orientation.enum';
import * as i0 from "@angular/core";
import * as i1 from "../../po-language/po-language.service";
import * as i2 from "@angular/common";
import * as i3 from "../../../components/po-button/po-button.component";
import * as i4 from "../../../components/po-icon/po-icon.component";
const _c0 = ["toaster"];
const _c1 = ["buttonClose"];
function PoToasterComponent_po_button_8_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "po-button", 11);
    i0.ɵɵlistener("p-click", function PoToasterComponent_po_button_8_Template_po_button_p_click_0_listener($event) { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r3.poToasterAction($event)); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵproperty("p-label", ctx_r1.actionLabel);
} }
const SPACE_BETWEEN_TOASTERS = 8;
const TOASTER_HEIGHT_DEFAULT = 62;
const TOASTER_HEIGHT_ACTION = 88;
/**
 * @docsPrivate
 *
 * @docsExtends PoToasterBaseComponent
 */
export class PoToasterComponent extends PoToasterBaseComponent {
    constructor(poLanguageService, changeDetector, elementeRef, renderer) {
        super();
        this.changeDetector = changeDetector;
        this.elementeRef = elementeRef;
        this.renderer = renderer;
        this.alive = true;
        /* Margem do Toaster referênte à sua orientação e posição*/
        this.margin = 0;
        /* Observable para monitorar o Close to Toaster */
        this.observableOnClose = new Subject();
        /* Posição do Toaster*/
        this.toasterPosition = 'po-toaster-bottom';
        this.language = poLanguageService.getShortLanguage();
        this.literals = {
            ...poToasterLiterals[this.language]
        };
    }
    ngOnDestroy() {
        this.alive = false;
    }
    ngAfterViewInit() {
        setTimeout(() => this.renderer.addClass(this.toaster.nativeElement, 'po-toaster-visible'));
    }
    /* Muda a posição do Toaster na tela*/
    changePosition(position) {
        const toasterSize = document.body.offsetWidth < 961 && this.action ? TOASTER_HEIGHT_ACTION : TOASTER_HEIGHT_DEFAULT;
        this.margin = SPACE_BETWEEN_TOASTERS + toasterSize * position + position * SPACE_BETWEEN_TOASTERS;
        if (this.orientation === PoToasterOrientation.Top) {
            this.toaster.nativeElement.style.top = this.margin + 'px';
        }
        else {
            this.toaster.nativeElement.style.bottom = this.margin + 'px';
        }
    }
    /* Fecha o componente Toaster */
    close() {
        this.observableOnClose.next(true);
    }
    setFadeOut() {
        this.renderer.removeClass(this.toaster.nativeElement, 'po-toaster-visible');
        this.renderer.addClass(this.toaster.nativeElement, 'po-toaster-invisible');
    }
    /* Configura o Toaster com os atributos passados para ele */
    configToaster(poToaster) {
        this.type = poToaster.type;
        this.message = poToaster.message;
        this.orientation = poToaster.orientation;
        this.position = poToaster.position;
        this.action = poToaster.action;
        this.actionLabel = poToaster.actionLabel;
        this.componentRef = poToaster.componentRef;
        /* Muda a orientação do Toaster */
        if (this.orientation === PoToasterOrientation.Top) {
            this.toasterPosition = 'po-toaster-top';
        }
        /* Muda a posição do Toaster */
        this.changePosition(this.position);
        if (this.type === PoToasterType.Error) {
            this.toaster.nativeElement.setAttribute('role', 'alert');
        }
        else if (this.action && this.actionLabel) {
            this.toaster.nativeElement.setAttribute('role', 'alertdialog');
        }
        else {
            this.toaster.nativeElement.setAttribute('role', 'status');
        }
        /* Switch para o tipo de Toaster */
        switch (this.type) {
            case PoToasterType.Error: {
                this.toasterType = 'po-toaster-error';
                this.icon = 'po-icon-warning';
                break;
            }
            case PoToasterType.Information: {
                this.toasterType = 'po-toaster-info';
                this.icon = 'po-icon-info';
                break;
            }
            case PoToasterType.Success: {
                this.toasterType = 'po-toaster-success';
                this.icon = 'po-icon-ok';
                break;
            }
            case PoToasterType.Warning: {
                this.toasterType = 'po-toaster-warning';
                this.icon = 'po-icon-warning';
                break;
            }
        }
        this.buttonClose.buttonElement.nativeElement.setAttribute('aria-label', this.literals.close);
        this.changeDetector.detectChanges();
    }
    getIcon() {
        return this.icon;
    }
    getToasterPosition() {
        return this.toasterPosition;
    }
    getToasterType() {
        return this.toasterType;
    }
    onButtonClose(event) {
        if (this.action && !this.actionLabel) {
            this.poToasterAction(event);
        }
        else {
            this.close();
        }
    }
    /* Chama a função passada pelo atributo `action` */
    poToasterAction(event) {
        this.action(this);
    }
}
PoToasterComponent.ɵfac = function PoToasterComponent_Factory(t) { return new (t || PoToasterComponent)(i0.ɵɵdirectiveInject(i1.PoLanguageService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Renderer2)); };
PoToasterComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PoToasterComponent, selectors: [["po-toaster"]], viewQuery: function PoToasterComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0, 5);
        i0.ɵɵviewQuery(_c1, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.toaster = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.buttonClose = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], decls: 13, vars: 7, consts: [["toaster", ""], [1, "po-toaster-icon"], [3, "p-icon"], [1, "po-toaster-actions"], [1, "po-toaster-message"], [1, "po-toaster-action"], ["p-type", "tertiary", 3, "p-label", "p-click", 4, "ngIf"], [1, "po-toaster-close"], [1, "po-toaster-divider"], ["p-icon", "po-icon-close", "p-type", "tertiary", 1, "po-toaster-button-close", 3, "p-click"], ["buttonClose", ""], ["p-type", "tertiary", 3, "p-label", "p-click"]], template: function PoToasterComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", null, 0)(2, "div", 1);
        i0.ɵɵelement(3, "po-icon", 2);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(4, "div", 3)(5, "div", 4);
        i0.ɵɵtext(6);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(7, "div", 5);
        i0.ɵɵtemplate(8, PoToasterComponent_po_button_8_Template, 1, 1, "po-button", 6);
        i0.ɵɵelementEnd()();
        i0.ɵɵelementStart(9, "div", 7);
        i0.ɵɵelement(10, "div", 8);
        i0.ɵɵelementStart(11, "po-button", 9, 10);
        i0.ɵɵlistener("p-click", function PoToasterComponent_Template_po_button_p_click_11_listener($event) { return ctx.onButtonClose($event); });
        i0.ɵɵelementEnd()()();
    } if (rf & 2) {
        i0.ɵɵclassMapInterpolate2("po-toaster ", ctx.getToasterType(), " ", ctx.getToasterPosition(), "");
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("p-icon", ctx.getIcon());
        i0.ɵɵadvance(3);
        i0.ɵɵtextInterpolate(ctx.message);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngIf", ctx.action && ctx.actionLabel);
    } }, dependencies: [i2.NgIf, i3.PoButtonComponent, i4.PoIconComponent], encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PoToasterComponent, [{
        type: Component,
        args: [{ selector: 'po-toaster', template: "<div #toaster class=\"po-toaster {{ getToasterType() }} {{ getToasterPosition() }}\">\n  <div class=\"po-toaster-icon\">\n    <po-icon [p-icon]=\"getIcon()\"></po-icon>\n  </div>\n\n  <div class=\"po-toaster-actions\">\n    <div class=\"po-toaster-message\">{{ message }}</div>\n    <div class=\"po-toaster-action\">\n      <po-button\n        *ngIf=\"action && actionLabel\"\n        (p-click)=\"poToasterAction($event)\"\n        [p-label]=\"actionLabel\"\n        p-type=\"tertiary\"\n      ></po-button>\n    </div>\n  </div>\n\n  <div class=\"po-toaster-close\">\n    <div class=\"po-toaster-divider\"></div>\n    <po-button\n      #buttonClose\n      class=\"po-toaster-button-close\"\n      (p-click)=\"onButtonClose($event)\"\n      p-icon=\"po-icon-close\"\n      p-type=\"tertiary\"\n    ></po-button>\n  </div>\n</div>\n" }]
    }], function () { return [{ type: i1.PoLanguageService }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.Renderer2 }]; }, { toaster: [{
            type: ViewChild,
            args: ['toaster']
        }], buttonClose: [{
            type: ViewChild,
            args: ['buttonClose']
        }] }); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG8tdG9hc3Rlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy91aS9zcmMvbGliL3NlcnZpY2VzL3BvLW5vdGlmaWNhdGlvbi9wby10b2FzdGVyL3BvLXRvYXN0ZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvdWkvc3JjL2xpYi9zZXJ2aWNlcy9wby1ub3RpZmljYXRpb24vcG8tdG9hc3Rlci9wby10b2FzdGVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFHTCxTQUFTLEVBSVQsU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFLL0IsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFFMUQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFFckUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLCtCQUErQixDQUFDOzs7Ozs7Ozs7O0lDWi9ELHFDQUtDO0lBSEMsa0xBQVcsZUFBQSw4QkFBdUIsQ0FBQSxJQUFDO0lBR3BDLGlCQUFZOzs7SUFGWCw0Q0FBdUI7O0FEWS9CLE1BQU0sc0JBQXNCLEdBQUcsQ0FBQyxDQUFDO0FBQ2pDLE1BQU0sc0JBQXNCLEdBQUcsRUFBRSxDQUFDO0FBQ2xDLE1BQU0scUJBQXFCLEdBQUcsRUFBRSxDQUFDO0FBRWpDOzs7O0dBSUc7QUFLSCxNQUFNLE9BQU8sa0JBQW1CLFNBQVEsc0JBQXNCO0lBb0I1RCxZQUNFLGlCQUFvQyxFQUM3QixjQUFpQyxFQUNoQyxXQUF3QixFQUN4QixRQUFvQjtRQUU1QixLQUFLLEVBQUUsQ0FBQztRQUpELG1CQUFjLEdBQWQsY0FBYyxD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YixpQ0FBYTtRQUd4QyxlQUEyQjtRQUEzQixvREFBMkI7O3VGRDJCdkIsa0JBQWtCO2NBSjlCLFNBQVM7MkJBQ0UsWUFBWTtxSkFLQSxPQUFPO2tCQUE1QixTQUFTO21CQUFDLFNBQVM7WUFDTSxXQUFXO2tCQUFwQyxTQUFTO21CQUFDLGFBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBPbkRlc3Ryb3ksXG4gIFJlbmRlcmVyMixcbiAgVmlld0NoaWxkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IHBvTG9jYWxlRGVmYXVsdCB9IGZyb20gJy4uLy4uL3BvLWxhbmd1YWdlL3BvLWxhbmd1YWdlLmNvbnN0YW50JztcblxuaW1wb3J0IHsgUG9MYW5ndWFnZVNlcnZpY2UgfSBmcm9tICcuLi8uLi9wby1sYW5ndWFnZS9wby1sYW5ndWFnZS5zZXJ2aWNlJztcbmltcG9ydCB7IHBvVG9hc3RlckxpdGVyYWxzIH0gZnJvbSAnLi9wby10b2FzdGVyLmxpdGVyYWxzJztcblxuaW1wb3J0IHsgUG9Ub2FzdGVyQmFzZUNvbXBvbmVudCB9IGZyb20gJy4vcG8tdG9hc3Rlci1iYXNlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBQb1RvYXN0ZXIgfSBmcm9tICcuL3BvLXRvYXN0ZXIuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBvVG9hc3RlclR5cGUgfSBmcm9tICcuL3BvLXRvYXN0ZXItdHlwZS5lbnVtJztcbmltcG9ydCB7IFBvVG9hc3Rlck9yaWVudGF0aW9uIH0gZnJvbSAnLi9wby10b2FzdGVyLW9yaWVudGF0aW9uLmVudW0nO1xuaW1wb3J0IHsgUG9CdXR0b25Db21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL3BvLWJ1dHRvbi9wby1idXR0b24uY29tcG9uZW50JztcblxuY29uc3QgU1BBQ0VfQkVUV0VFTl9UT0FTVEVSUyA9IDg7XG5jb25zdCBUT0FTVEVSX0hFSUdIVF9ERUZBVUxUID0gNjI7XG5jb25zdCBUT0FTVEVSX0hFSUdIVF9BQ1RJT04gPSA4ODtcblxuLyoqXG4gKiBAZG9jc1ByaXZhdGVcbiAqXG4gKiBAZG9jc0V4dGVuZHMgUG9Ub2FzdGVyQmFzZUNvbXBvbmVudFxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdwby10b2FzdGVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3BvLXRvYXN0ZXIuY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIFBvVG9hc3RlckNvbXBvbmVudCBleHRlbmRzIFBvVG9hc3RlckJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuICAvKiBDb21wb25lbnRlIHRvYXN0ZXIgKi9cbiAgQFZpZXdDaGlsZCgndG9hc3RlcicpIHRvYXN0ZXI6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGQoJ2J1dHRvbkNsb3NlJykgYnV0dG9uQ2xvc2U6IFBvQnV0dG9uQ29tcG9uZW50O1xuXG4gIGFsaXZlOiBib29sZWFuID0gdHJ1ZTtcbiAgbGFuZ3VhZ2U6IHN0cmluZztcbiAgbGl0ZXJhbHM6IGFueTtcblxuICAvKiDDjWNvbmUgZG8gVG9hc3RlciAqL1xuICBwcml2YXRlIGljb246IHN0cmluZztcbiAgLyogTWFyZ2VtIGRvIFRvYXN0ZXIgcmVmZXLDqm50ZSDDoCBzdWEgb3JpZW50YcOnw6NvIGUgcG9zacOnw6NvKi9cbiAgcHJpdmF0ZSBtYXJnaW46IG51bWJlciA9IDA7XG4gIC8qIE9ic2VydmFibGUgcGFyYSBtb25pdG9yYXIgbyBDbG9zZSB0byBUb2FzdGVyICovXG4gIHByaXZhdGUgb2JzZXJ2YWJsZU9uQ2xvc2UgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG4gIC8qIFBvc2nDp8OjbyBkbyBUb2FzdGVyKi9cbiAgcHJpdmF0ZSB0b2FzdGVyUG9zaXRpb246IHN0cmluZyA9ICdwby10b2FzdGVyLWJvdHRvbSc7XG4gIC8qIFRpcG8gZG8gVG9hc3RlciAqL1xuICBwcml2YXRlIHRvYXN0ZXJUeXBlOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcG9MYW5ndWFnZVNlcnZpY2U6IFBvTGFuZ3VhZ2VTZXJ2aWNlLFxuICAgIHB1YmxpYyBjaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgcHJpdmF0ZSBlbGVtZW50ZVJlZj86IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSByZW5kZXJlcj86IFJlbmRlcmVyMlxuICApIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMubGFuZ3VhZ2UgPSBwb0xhbmd1YWdlU2VydmljZS5nZXRTaG9ydExhbmd1YWdlKCk7XG4gICAgdGhpcy5saXRlcmFscyA9IHtcbiAgICAgIC4uLnBvVG9hc3RlckxpdGVyYWxzW3RoaXMubGFuZ3VhZ2VdXG4gICAgfTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuYWxpdmUgPSBmYWxzZTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy50b2FzdGVyLm5hdGl2ZUVsZW1lbnQsICdwby10b2FzdGVyLXZpc2libGUnKSk7XG4gIH1cblxuICAvKiBNdWRhIGEgcG9zacOnw6NvIGRvIFRvYXN0ZXIgbmEgdGVsYSovXG4gIGNoYW5nZVBvc2l0aW9uKHBvc2l0aW9uOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCB0b2FzdGVyU2l6ZSA9IGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGggPCA5NjEgJiYgdGhpcy5hY3Rpb24gPyBUT0FTVEVSX0hFSUdIVF9BQ1RJT04gOiBUT0FTVEVSX0hFSUdIVF9ERUZBVUxUO1xuICAgIHRoaXMubWFyZ2luID0gU1BBQ0VfQkVUV0VFTl9UT0FTVEVSUyArIHRvYXN0ZXJTaXplICogcG9zaXRpb24gKyBwb3NpdGlvbiAqIFNQQUNFX0JFVFdFRU5fVE9BU1RFUlM7XG5cbiAgICBpZiAodGhpcy5vcmllbnRhdGlvbiA9PT0gUG9Ub2FzdGVyT3JpZW50YXRpb24uVG9wKSB7XG4gICAgICB0aGlzLnRvYXN0ZXIubmF0aXZlRWxlbWVudC5zdHlsZS50b3AgPSB0aGlzLm1hcmdpbiArICdweCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudG9hc3Rlci5uYXRpdmVFbGVtZW50LnN0eWxlLmJvdHRvbSA9IHRoaXMubWFyZ2luICsgJ3B4JztcbiAgICB9XG4gIH1cblxuICAvKiBGZWNoYSBvIGNvbXBvbmVudGUgVG9hc3RlciAqL1xuICBjbG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLm9ic2VydmFibGVPbkNsb3NlLm5leHQodHJ1ZSk7XG4gIH1cblxuICBzZXRGYWRlT3V0KCkge1xuICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy50b2FzdGVyLm5hdGl2ZUVsZW1lbnQsICdwby10b2FzdGVyLXZpc2libGUnKTtcbiAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMudG9hc3Rlci5uYXRpdmVFbGVtZW50LCAncG8tdG9hc3Rlci1pbnZpc2libGUnKTtcbiAgfVxuXG4gIC8qIENvbmZpZ3VyYSBvIFRvYXN0ZXIgY29tIG9zIGF0cmlidXRvcyBwYXNzYWRvcyBwYXJhIGVsZSAqL1xuICBjb25maWdUb2FzdGVyKHBvVG9hc3RlcjogUG9Ub2FzdGVyKSB7XG4gICAgdGhpcy50eXBlID0gcG9Ub2FzdGVyLnR5cGU7XG4gICAgdGhpcy5tZXNzYWdlID0gcG9Ub2FzdGVyLm1lc3NhZ2U7XG4gICAgdGhpcy5vcmllbnRhdGlvbiA9IHBvVG9hc3Rlci5vcmllbnRhdGlvbjtcbiAgICB0aGlzLnBvc2l0aW9uID0gcG9Ub2FzdGVyLnBvc2l0aW9uO1xuICAgIHRoaXMuYWN0aW9uID0gcG9Ub2FzdGVyLmFjdGlvbjtcbiAgICB0aGlzLmFjdGlvbkxhYmVsID0gcG9Ub2FzdGVyLmFjdGlvbkxhYmVsO1xuICAgIHRoaXMuY29tcG9uZW50UmVmID0gcG9Ub2FzdGVyLmNvbXBvbmVudFJlZjtcblxuICAgIC8qIE11ZGEgYSBvcmllbnRhw6fDo28gZG8gVG9hc3RlciAqL1xuICAgIGlmICh0aGlzLm9yaWVudGF0aW9uID09PSBQb1RvYXN0ZXJPcmllbnRhdGlvbi5Ub3ApIHtcbiAgICAgIHRoaXMudG9hc3RlclBvc2l0aW9uID0gJ3BvLXRvYXN0ZXItdG9wJztcbiAgICB9XG5cbiAgICAvKiBNdWRhIGEgcG9zacOnw6NvIGRvIFRvYXN0ZXIgKi9cbiAgICB0aGlzLmNoYW5nZVBvc2l0aW9uKHRoaXMucG9zaXRpb24pO1xuXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gUG9Ub2FzdGVyVHlwZS5FcnJvcikge1xuICAgICAgdGhpcy50b2FzdGVyLm5hdGl2ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2FsZXJ0Jyk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmFjdGlvbiAmJiB0aGlzLmFjdGlvbkxhYmVsKSB7XG4gICAgICB0aGlzLnRvYXN0ZXIubmF0aXZlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnYWxlcnRkaWFsb2cnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50b2FzdGVyLm5hdGl2ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3N0YXR1cycpO1xuICAgIH1cblxuICAgIC8qIFN3aXRjaCBwYXJhIG8gdGlwbyBkZSBUb2FzdGVyICovXG4gICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcbiAgICAgIGNhc2UgUG9Ub2FzdGVyVHlwZS5FcnJvcjoge1xuICAgICAgICB0aGlzLnRvYXN0ZXJUeXBlID0gJ3BvLXRvYXN0ZXItZXJyb3InO1xuICAgICAgICB0aGlzLmljb24gPSAncG8taWNvbi13YXJuaW5nJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFBvVG9hc3RlclR5cGUuSW5mb3JtYXRpb246IHtcbiAgICAgICAgdGhpcy50b2FzdGVyVHlwZSA9ICdwby10b2FzdGVyLWluZm8nO1xuICAgICAgICB0aGlzLmljb24gPSAncG8taWNvbi1pbmZvJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFBvVG9hc3RlclR5cGUuU3VjY2Vzczoge1xuICAgICAgICB0aGlzLnRvYXN0ZXJUeXBlID0gJ3BvLXRvYXN0ZXItc3VjY2Vzcyc7XG4gICAgICAgIHRoaXMuaWNvbiA9ICdwby1pY29uLW9rJztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFBvVG9hc3RlclR5cGUuV2FybmluZzoge1xuICAgICAgICB0aGlzLnRvYXN0ZXJUeXBlID0gJ3BvLXRvYXN0ZXItd2FybmluZyc7XG4gICAgICAgIHRoaXMuaWNvbiA9ICdwby1pY29uLXdhcm5pbmcnO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmJ1dHRvbkNsb3NlLmJ1dHRvbkVsZW1lbnQubmF0aXZlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCB0aGlzLmxpdGVyYWxzLmNsb3NlKTtcbiAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIGdldEljb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaWNvbjtcbiAgfVxuXG4gIGdldFRvYXN0ZXJQb3NpdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy50b2FzdGVyUG9zaXRpb247XG4gIH1cblxuICBnZXRUb2FzdGVyVHlwZSgpIHtcbiAgICByZXR1cm4gdGhpcy50b2FzdGVyVHlwZTtcbiAgfVxuXG4gIG9uQnV0dG9uQ2xvc2UoZXZlbnQpIHtcbiAgICBpZiAodGhpcy5hY3Rpb24gJiYgIXRoaXMuYWN0aW9uTGFiZWwpIHtcbiAgICAgIHRoaXMucG9Ub2FzdGVyQWN0aW9uKGV2ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qIENoYW1hIGEgZnVuw6fDo28gcGFzc2FkYSBwZWxvIGF0cmlidXRvIGBhY3Rpb25gICovXG4gIHBvVG9hc3RlckFjdGlvbihldmVudCk6IHZvaWQge1xuICAgIHRoaXMuYWN0aW9uKHRoaXMpO1xuICB9XG59XG4iLCI8ZGl2ICN0b2FzdGVyIGNsYXNzPVwicG8tdG9hc3RlciB7eyBnZXRUb2FzdGVyVHlwZSgpIH19IHt7IGdldFRvYXN0ZXJQb3NpdGlvbigpIH19XCI+XG4gIDxkaXYgY2xhc3M9XCJwby10b2FzdGVyLWljb25cIj5cbiAgICA8cG8taWNvbiBbcC1pY29uXT1cImdldEljb24oKVwiPjwvcG8taWNvbj5cbiAgPC9kaXY+XG5cbiAgPGRpdiBjbGFzcz1cInBvLXRvYXN0ZXItYWN0aW9uc1wiPlxuICAgIDxkaXYgY2xhc3M9XCJwby10b2FzdGVyLW1lc3NhZ2VcIj57eyBtZXNzYWdlIH19PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cInBvLXRvYXN0ZXItYWN0aW9uXCI+XG4gICAgICA8cG8tYnV0dG9uXG4gICAgICAgICpuZ0lmPVwiYWN0aW9uICYmIGFjdGlvbkxhYmVsXCJcbiAgICAgICAgKHAtY2xpY2spPVwicG9Ub2FzdGVyQWN0aW9uKCRldmVudClcIlxuICAgICAgICBbcC1sYWJlbF09XCJhY3Rpb25MYWJlbFwiXG4gICAgICAgIHAtdHlwZT1cInRlcnRpYXJ5XCJcbiAgICAgID48L3BvLWJ1dHRvbj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5cbiAgPGRpdiBjbGFzcz1cInBvLXRvYXN0ZXItY2xvc2VcIj5cbiAgICA8ZGl2IGNsYXNzPVwicG8tdG9hc3Rlci1kaXZpZGVyXCI+PC9kaXY+XG4gICAgPHBvLWJ1dHRvblxuICAgICAgI2J1dHRvbkNsb3NlXG4gICAgICBjbGFzcz1cInBvLXRvYXN0ZXItYnV0dG9uLWNsb3NlXCJcbiAgICAgIChwLWNsaWNrKT1cIm9uQnV0dG9uQ2xvc2UoJGV2ZW50KVwiXG4gICAgICBwLWljb249XCJwby1pY29uLWNsb3NlXCJcbiAgICAgIHAtdHlwZT1cInRlcnRpYXJ5XCJcbiAgICA+PC9wby1idXR0b24+XG4gIDwvZGl2PlxuPC9kaXY+XG4iXX0=