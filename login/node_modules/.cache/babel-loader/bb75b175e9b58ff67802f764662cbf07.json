{"ast":null,"code":"var _jsxFileName = \"/Users/felipemayer/Projetos/repository-md/login/src/context/AuthContext.jsx\",\n    _s = $RefreshSig$();\n\nimport { createContext } from \"react\";\nimport { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { Navigate } from \"react-router-dom\";\nimport { api } from \"../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  useEffect(() => {\n    const loadingStoreData = () => {\n      const storageUser = localStorage.getItem(\"@Auth:user\");\n      const storageToken = localStorage.getItem(\"@Auth:token\");\n\n      if (storageUser && storageToken) {\n        setUser(storageUser);\n      }\n    };\n\n    loadingStoreData();\n  }, []);\n\n  const signIn = async _ref2 => {\n    let {\n      email,\n      password\n    } = _ref2;\n\n    try {\n      const response = await api.post(\"/auth\", {\n        email,\n        password\n      });\n\n      if (response.data.error) {\n        alert(response.data.error);\n      } else {\n        setUser(response.data);\n        api.defaults.headers.common[\"Authorization\"] = `Bearer ${response.data.token}`;\n        localStorage.setItem(\"@Auth:user\", JSON.stringify(response.data.user));\n        localStorage.setItem(\"@Auth:token\", response.data.token);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const singOut = () => {\n    localStorage.clear();\n    setUser(null);\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 12\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      signIn,\n      singOut,\n      signed: !!user\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"5s2qRsV95gTJBmaaTh11GoxYeGE=\");\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useEffect","Navigate","api","AuthContext","AuthProvider","children","user","setUser","loadingStoreData","storageUser","localStorage","getItem","storageToken","signIn","email","password","response","post","data","error","alert","defaults","headers","common","token","setItem","JSON","stringify","console","log","singOut","clear","signed"],"sources":["/Users/felipemayer/Projetos/repository-md/login/src/context/AuthContext.jsx"],"sourcesContent":["import { createContext } from \"react\";\nimport { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { Navigate } from \"react-router-dom\";\nimport { api } from \"../services/api\";\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    const loadingStoreData = () => {\n      const storageUser = localStorage.getItem(\"@Auth:user\");\n      const storageToken = localStorage.getItem(\"@Auth:token\");\n\n      if (storageUser && storageToken) {\n        setUser(storageUser);\n      }\n    };\n    loadingStoreData();\n  }, []);\n\n  const signIn = async ({ email, password }) => {\n    try {\n      const response = await api.post(\"/auth\", { email, password });\n      if (response.data.error) {\n        alert(response.data.error);\n      } else {\n        setUser(response.data);\n        api.defaults.headers.common[\n          \"Authorization\"\n        ] = `Bearer ${response.data.token}`;\n\n        localStorage.setItem(\"@Auth:user\", JSON.stringify(response.data.user));\n        localStorage.setItem(\"@Auth:token\", response.data.token);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const singOut = () => {\n    localStorage.clear();\n    setUser(null);\n    return <Navigate to=\"/\" />;\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        signIn,\n        singOut,\n        signed: !!user,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":";;;AAAA,SAASA,aAAT,QAA8B,OAA9B;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,SAASC,GAAT,QAAoB,iBAApB;;AAEA,OAAO,MAAMC,WAAW,gBAAGL,aAAa,EAAjC;AAEP,OAAO,MAAMM,YAAY,GAAG,QAAkB;EAAA;;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAC5C,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBR,QAAQ,CAAC,IAAD,CAAhC;EAEAC,SAAS,CAAC,MAAM;IACd,MAAMQ,gBAAgB,GAAG,MAAM;MAC7B,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAApB;MACA,MAAMC,YAAY,GAAGF,YAAY,CAACC,OAAb,CAAqB,aAArB,CAArB;;MAEA,IAAIF,WAAW,IAAIG,YAAnB,EAAiC;QAC/BL,OAAO,CAACE,WAAD,CAAP;MACD;IACF,CAPD;;IAQAD,gBAAgB;EACjB,CAVQ,EAUN,EAVM,CAAT;;EAYA,MAAMK,MAAM,GAAG,eAA+B;IAAA,IAAxB;MAAEC,KAAF;MAASC;IAAT,CAAwB;;IAC5C,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMd,GAAG,CAACe,IAAJ,CAAS,OAAT,EAAkB;QAAEH,KAAF;QAASC;MAAT,CAAlB,CAAvB;;MACA,IAAIC,QAAQ,CAACE,IAAT,CAAcC,KAAlB,EAAyB;QACvBC,KAAK,CAACJ,QAAQ,CAACE,IAAT,CAAcC,KAAf,CAAL;MACD,CAFD,MAEO;QACLZ,OAAO,CAACS,QAAQ,CAACE,IAAV,CAAP;QACAhB,GAAG,CAACmB,QAAJ,CAAaC,OAAb,CAAqBC,MAArB,CACE,eADF,IAEK,UAASP,QAAQ,CAACE,IAAT,CAAcM,KAAM,EAFlC;QAIAd,YAAY,CAACe,OAAb,CAAqB,YAArB,EAAmCC,IAAI,CAACC,SAAL,CAAeX,QAAQ,CAACE,IAAT,CAAcZ,IAA7B,CAAnC;QACAI,YAAY,CAACe,OAAb,CAAqB,aAArB,EAAoCT,QAAQ,CAACE,IAAT,CAAcM,KAAlD;MACD;IACF,CAbD,CAaE,OAAOL,KAAP,EAAc;MACdS,OAAO,CAACC,GAAR,CAAYV,KAAZ;IACD;EACF,CAjBD;;EAmBA,MAAMW,OAAO,GAAG,MAAM;IACpBpB,YAAY,CAACqB,KAAb;IACAxB,OAAO,CAAC,IAAD,CAAP;IACA,oBAAO,QAAC,QAAD;MAAU,EAAE,EAAC;IAAb;MAAA;MAAA;MAAA;IAAA,QAAP;EACD,CAJD;;EAMA,oBACE,QAAC,WAAD,CAAa,QAAb;IACE,KAAK,EAAE;MACLD,IADK;MAELO,MAFK;MAGLiB,OAHK;MAILE,MAAM,EAAE,CAAC,CAAC1B;IAJL,CADT;IAAA,UAQGD;EARH;IAAA;IAAA;IAAA;EAAA,QADF;AAYD,CApDM;;GAAMD,Y;;KAAAA,Y"},"metadata":{},"sourceType":"module"}